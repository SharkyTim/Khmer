<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <!-- Prevent user from zooming on mobile -->
  <meta name="viewport" content="width=device-width, maximum-scale=1.0, user-scalable=no">
  <title>Khmer 100-Card Learning Game</title>
  <style>
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --success-color: #27ae60;
      --text-color: #2c3e50;
    }

    * {
      box-sizing: border-box;
      touch-action: manipulation; /* Helps with mobile tapping */
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 10px;
      background-color: #f8f9fa;
      color: var(--text-color);
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      text-align: center;
    }

    .header {
      padding: 20px 0;
    }

    .cards-selection {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
      gap: 8px;
      margin-bottom: 20px;
    }

    .card-option {
      padding: 20px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      text-align: center;
      cursor: pointer;
      transition: transform 0.1s;
      user-select: none;
      min-height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
    }

    .card-option.selected {
      background: var(--success-color);
      color: white;
      transform: scale(0.98);
    }

    .card-option:active {
      transform: scale(0.96);
    }

    .controls {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      margin: 20px 0;
    }

    button {
      padding: 12px 24px;
      border: none;
      border-radius: 25px;
      background: var(--secondary-color);
      color: white;
      font-size: 1rem;
      cursor: pointer;
      transition: opacity 0.2s;
      min-width: 140px;
    }

    button:active {
      opacity: 0.8;
    }

    /* The card section which appears after "Start Practice" */
    .card-section {
      display: none; /* hidden until user starts practice */
      margin-top: 20px;
    }

    .card-container {
      width: 90%;
      max-width: 400px;
      height: 250px;
      margin: 0 auto;
      perspective: 1000px;
    }

    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }

    .card-flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border-radius: 15px;
      padding: 20px;
      background: white;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      font-size: 1.4rem;
      text-align: center;
    }

    .card-back {
      transform: rotateY(180deg);
      background: var(--primary-color);
      color: white;
    }

    /* TTS (Play Audio) button */
    .tts-container {
      margin-top: 10px;
    }

    .tts-button {
      display: inline-block;
      padding: 10px 16px;
      font-size: 0.9rem;
      background: var(--success-color);
      border-radius: 25px;
      margin-top: 5px;
      cursor: pointer;
      color: white;
      border: none;
    }

    @media (max-width: 480px) {
      .card-option {
        font-size: 1rem;
        min-height: 70px;
        padding: 15px;
      }
      button {
        width: 100%;
        padding: 15px;
      }
      .card-container {
        height: 220px;
      }
    }
  </style>
</head>
<body>
  <div class="container">

    <!-- HEADER -->
    <div class="header">
      <h1>Learn Khmer üá∞üá≠</h1>
      <p>Selected: <span id="selected-count">0</span>/100</p>
    </div>

    <!-- SELECTION GRID -->
    <div class="cards-selection" id="cards-selection"></div>

    <!-- INITIAL CONTROLS -->
    <div class="controls">
      <button id="select-all">Select All</button>
      <button id="deselect-all">Deselect All</button>
      <button id="start-training">Start Practice</button>
    </div>

    <!-- CARD SECTION (hidden until we start) -->
    <div class="card-section" id="card-section">
      <div class="card-container" id="card-container">
        <div class="card-inner" id="card-inner">
          <div class="card-face card-front" id="card-front"></div>
          <div class="card-face card-back" id="card-back"></div>
        </div>
      </div>

      <div class="tts-container">
        <button class="tts-button" id="tts-button">Hear Pronunciation üîä</button>
      </div>
    </div>

    <!-- PRACTICE CONTROLS -->
    <div class="controls" id="practice-controls" style="display: none;">
      <button id="got-it">I Know It ‚úÖ</button>
      <button id="try-again">Try Again üîÑ</button>
      <button id="end-session">End Session ‚èπÔ∏è</button>
    </div>
  </div>

  <!-- HIDDEN AUDIO ELEMENT -->
  <audio id="tts-audio" autoplay playsinline></audio>

  <script>
    /*******************************************************************
     *  100 Khmer Words with MP3 links from GitHub (example raw paths).
     *  Make sure each "audio" URL matches an existing file in your repo.
     ********************************************************************/
    const khmerWords = [
      // (1) Greetings (5)
      {
        front: '·ûü·ûΩ·ûü·üí·ûè·û∏',      
        phonetic: 'su≈ès-d√©i',
        english: 'Hello',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/hello.mp3'
      },
      {
        front: '·ûá·ûò·üí·ûö·û∂·ûî·ûü·ûΩ·ûö',
        phonetic: 'chum-reep-su≈èr',
        english: 'Formal Greeting',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/formal_greeting.mp3'
      },
      {
        front: '·û¢·ûö·ûª·ûé·ûü·ûΩ·ûü·üí·ûè·û∏',
        phonetic: 'a-run su≈ès-d√©i',
        english: 'Good morning',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/good_morning.mp3'
      },
      {
        front: '·ûö·û∂·ûè·üí·ûö·û∏·ûü·ûΩ·ûü·üí·ûè·û∏',
        phonetic: 'rea-trei su≈ès-d√©i',
        english: 'Good night',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/good_night.mp3'
      },
      {
        front: '·ûõ·û∂·û†·ûæ·ûô',
        phonetic: 'lia h√¢oy',
        english: 'Goodbye',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/goodbye.mp3'
      },

      // (2) Common Phrases (5)
      {
        front: '·û¢·ûö·ûÇ·ûª·ûé',
        phonetic: 'aw-kohn',
        english: 'Thank you',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/thank_you.mp3'
      },
      {
        front: '·ûü·ûª·üÜ·ûë·üÑ·ûü',
        phonetic: 'som-toh',
        english: 'Sorry',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/sorry.mp3'
      },
      {
        front: '·ûî·û∂·ûë',
        phonetic: 'baat',
        english: 'Yes (male)',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/yes_male.mp3'
      },
      {
        front: '·ûÖ·û∂·ûü',
        phonetic: 'chaah',
        english: 'Yes (female)',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/yes_female.mp3'
      },
      {
        front: '·ûë·üÅ',
        phonetic: 'te',
        english: 'No',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/no.mp3'
      },

      // (3) Food (5)
      {
        front: '·ûî·û∂·ûô',
        phonetic: 'bai',
        english: 'Rice',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/rice.mp3'
      },
      {
        front: '·ûë·ûπ·ûÄ',
        phonetic: 'dt≈≠k',
        english: 'Water',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/water.mp3'
      },
      {
        front: '·ûè·üí·ûö·û∏',
        phonetic: 'trei',
        english: 'Fish',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/fish.mp3'
      },
      {
        front: '·ûü·û∂·ûÖ·üã',
        phonetic: 'sach',
        english: 'Meat',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/meat.mp3'
      },
      {
        front: '·ûï·üí·ûõ·üÇ·ûà·ûæ',
        phonetic: 'plae-chheu',
        english: 'Fruit',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/fruit.mp3'
      },

      // (4) Numbers (10) => 1-10
      {
        front: '·ûò·ûΩ·ûô',
        phonetic: 'mu≈èy',
        english: 'One',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/one.mp3'
      },
      {
        front: '·ûñ·û∏·ûö',
        phonetic: 'pƒ´',
        english: 'Two',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/two.mp3'
      },
      {
        front: '·ûî·û∏',
        phonetic: 'bei',
        english: 'Three',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/three.mp3'
      },
      {
        front: '·ûî·ûΩ·ûì',
        phonetic: 'bu≈èn',
        english: 'Four',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/four.mp3'
      },
      {
        front: '·ûî·üí·ûö·û∂·üÜ',
        phonetic: 'prƒÉm',
        english: 'Five',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/five.mp3'
      },
      {
        front: '·ûî·üí·ûö·û∂·üÜ·ûò·ûΩ·ûô',
        phonetic: 'prƒÉm-mu≈èy',
        english: 'Six',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/six.mp3'
      },
      {
        front: '·ûî·üí·ûö·û∂·üÜ·ûñ·û∏·ûö',
        phonetic: 'prƒÉm-pƒ´',
        english: 'Seven',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/seven.mp3'
      },
      {
        front: '·ûî·üí·ûö·û∂·üÜ·ûî·û∏',
        phonetic: 'prƒÉm-bei',
        english: 'Eight',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/eight.mp3'
      },
      {
        front: '·ûî·üí·ûö·û∂·üÜ·ûî·ûΩ·ûì',
        phonetic: 'prƒÉm-bu≈èn',
        english: 'Nine',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/nine.mp3'
      },
      {
        front: '·ûä·ûî·üã',
        phonetic: 'dop',
        english: 'Ten',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/ten.mp3'
      },

      // (5) Family (5)
      {
        front: '·û™·ûñ·ûª·ûÄ',
        phonetic: 'ov puk',
        english: 'Father',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/father.mp3'
      },
      {
        front: '·ûò·üí·ûè·û∂·ûô',
        phonetic: 'mdaay',
        english: 'Mother',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/mother.mp3'
      },
      {
        front: '·ûî·üí·û¢·ûº·ûì',
        phonetic: 'p ºoon',
        english: 'Sibling',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/sibling.mp3'
      },
      {
        front: '·ûî·ûÑ',
        phonetic: 'b…ë…ëng',
        english: 'Elder sibling',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/elder_sibling.mp3'
      },
      {
        front: '·ûÄ·ûº·ûì',
        phonetic: 'koun',
        english: 'Child',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/child.mp3'
      },

      // (6) Time (5)
      {
        front: '·ûê·üí·ûÑ·üÉ',
        phonetic: 'thngay',
        english: 'Day',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/day.mp3'
      },
      {
        front: '·ûô·ûî·üã',
        phonetic: 'yup',
        english: 'Night',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/night.mp3'
      },
      {
        front: '·ûÅ·üÇ',
        phonetic: 'khae',
        english: 'Month',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/month.mp3'
      },
      {
        front: '·ûÜ·üí·ûì·û∂·üÜ',
        phonetic: 'chnam',
        english: 'Year',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/year.mp3'
      },
      {
        front: '·ûò·üâ·üÑ·ûÑ',
        phonetic: 'maong',
        english: 'Hour',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/hour.mp3'
      },

      // (7) Colors (5)
      {
        front: '·ûÄ·üí·ûö·û†·ûò',
        phonetic: 'kr…ëh…ë…ëm',
        english: 'Red',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/red.mp3'
      },
      {
        front: '·ûÅ·üÄ·ûú',
        phonetic: 'khiev',
        english: 'Blue',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/blue.mp3'
      },
      {
        front: '·ûî·üÉ·ûè·ûÑ',
        phonetic: 'bait…ë…ëng',
        english: 'Green',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/green.mp3'
      },
      {
        front: '·ûõ·ûø·ûÑ',
        phonetic: 'lu…ông',
        english: 'Yellow',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/yellow.mp3'
      },
      {
        front: '·ûü',
        phonetic: 's…ë…ë',
        english: 'White',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/white.mp3'
      },

      // (8) Verbs (5)
      {
        front: '·ûâ·üâ·û∂·üÜ',
        phonetic: 'nham',
        english: 'Eat',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/eat.mp3'
      },
      {
        front: '·ûï·ûπ·ûÄ',
        phonetic: 'ph…ôk',
        english: 'Drink',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/drink.mp3'
      },
      {
        front: '·ûä·üÅ·ûÄ',
        phonetic: 'deek',
        english: 'Sleep',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/sleep.mp3'
      },
      {
        front: '·û¢·û∂·ûì',
        phonetic: 'aan',
        english: 'Read',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/read.mp3'
      },
      {
        front: '·ûü·ûö·ûü·üÅ·ûö',
        phonetic: 's…ë…ë see',
        english: 'Write',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/write.mp3'
      },

      // (9) Places (5)
      {
        front: '·ûï·üí·ûë·üá',
        phonetic: 'pteah',
        english: 'House',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/house.mp3'
      },
      {
        front: '·ûü·û∂·ûõ·û∂',
        phonetic: 'sa-la',
        english: 'School',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/school.mp3'
      },
      {
        front: '·ûï·üí·ûü·û∂·ûö',
        phonetic: 'psaa',
        english: 'Market',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/market.mp3'
      },
      {
        front: '·ûú·ûè·üí·ûè',
        phonetic: 'v≈è…ôt',
        english: 'Pagoda',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/pagoda.mp3'
      },
      {
        front: '·ûö·ûä·üí·ûã·û∂·ûó·û∑·ûî·û∂·ûõ',
        phonetic: 'r≈è…ôtthaaphi ºbaal',
        english: 'Government',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/government.mp3'
      },

      // (10) Animals (5)
      {
        front: '·ûÜ·üí·ûÄ·üÇ',
        phonetic: 'chhkae',
        english: 'Dog',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/dog.mp3'
      },
      {
        front: '·ûÜ·üí·ûò·û∂',
        phonetic: 'chhmaa',
        english: 'Cat',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/cat.mp3'
      },
      {
        front: '·ûÇ·üÑ',
        phonetic: 'koo',
        english: 'Cow',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/cow.mp3'
      },
      {
        front: '·ûò·û∂·ûì·üã',
        phonetic: 'm≈è…ôn',
        english: 'Chicken',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/chicken.mp3'
      },
      {
        front: '·ûÄ·ûÑ·üí·ûÄ·üÇ·ûî',
        phonetic: 'k…ëngkaep',
        english: 'Frog',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/frog.mp3'
      },

      // (11) Body Parts (5)
      {
        front: '·ûÄ·üí·ûî·û∂·ûõ',
        phonetic: 'kbaal',
        english: 'Head',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/head.mp3'
      },
      {
        front: '·ûä·üÉ',
        phonetic: 'day',
        english: 'Hand',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/hand.mp3'
      },
      {
        front: '·ûá·ûæ·ûÑ',
        phonetic: 'c…ô…ông',
        english: 'Leg',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/leg.mp3'
      },
      {
        front: '·ûó·üí·ûì·üÇ·ûÄ',
        phonetic: 'pn…õ…õk',
        english: 'Eye',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/eye.mp3'
      },
      {
        front: '·ûè·üí·ûö·ûÖ·üÄ·ûÄ',
        phonetic: 'tr…ëci…ôk',
        english: 'Ear',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/ear.mp3'
      },

      // (12) Weather (5)
      {
        front: '·ûó·üí·ûõ·üÄ·ûÑ',
        phonetic: 'phli…ông',
        english: 'Rain',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/rain.mp3'
      },
      {
        front: '·ûÄ·üí·ûä·üÖ',
        phonetic: 'kdao',
        english: 'Hot',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/hot.mp3'
      },
      {
        front: '·ûè·üí·ûö·ûá·û∂·ûÄ·üã',
        phonetic: 'tr…ëcheak',
        english: 'Cold',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/cold.mp3'
      },
      {
        front: '·ûÅ·üí·ûô·ûõ·üã',
        phonetic: 'ky…ël',
        english: 'Wind',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/wind.mp3'
      },
      {
        front: '·ûñ·ûì·üí·ûõ·û∫',
        phonetic: 'p≈≠…ônl…®…®',
        english: 'Light',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/light.mp3'
      },

      // (13) Transportation (5)
      {
        front: '·ûö·ûê·ûô·ûì·üí·ûè',
        phonetic: 'r…î…ît y≈≠…ôn',
        english: 'Car',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/car.mp3'
      },
      {
        front: '·ûò·üâ·ûº·ûè·ûº',
        phonetic: 'moutou',
        english: 'Motorcycle',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/motorcycle.mp3'
      },
      {
        front: '·ûô·û∂·ûì·ûä·üí·ûã·û∂·ûì',
        phonetic: 'yien t ∞aan',
        english: 'Bus Station',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/bus_station.mp3'
      },
      {
        front: '·ûô·ûì·üí·ûè·û†·üÑ·üá',
        phonetic: 'y≈≠…ôn h…ëh',
        english: 'Airplane',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/airplane.mp3'
      },
      {
        front: '·ûë·ûº·ûÄ',
        phonetic: 'tuuk',
        english: 'Boat',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/boat.mp3'
      },

      // (14) Technology (5)
      {
        front: '·ûë·ûº·ûö·ûü·üê·ûñ·üí·ûë',
        phonetic: 'tuurasap',
        english: 'Phone',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/phone.mp3'
      },
      {
        front: '·ûÄ·ûª·üÜ·ûñ·üí·ûô·ûº·ûë·üê·ûö',
        phonetic: 'kompyuut…î…ô',
        english: 'Computer',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/computer.mp3'
      },
      {
        front: '·û¢·üä·û∏·ûì·ûí·û∫·ûé·û∑·ûè',
        phonetic: 'int…®…®n…ôt',
        english: 'Internet',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/internet.mp3'
      },
      {
        front: '·ûÄ·û∂·ûò·üÅ·ûö·üâ·û∂',
        phonetic: 'kaameeraa',
        english: 'Camera',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/camera.mp3'
      },
      {
        front: '·ûê·û∂·ûò·ûñ·ûõ',
        phonetic: 'thaam…ëp≈≠…ôl',
        english: 'Energy',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/energy.mp3'
      },

      // (15) Emotions (5)
      {
        front: '·ûö·û∏·ûÄ·ûö·û∂·ûô',
        phonetic: 'rik-reay',
        english: 'Happy',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/happy.mp3'
      },
      {
        front: '·ûü·ûî·üí·ûî·û∂·ûô·ûÖ·û∑·ûè·üí·ûè',
        phonetic: 'sab-bay-chet',
        english: 'Joyful',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/joyful.mp3'
      },
      {
        front: '·ûñ·üí·ûö·ûΩ·ûô·ûî·û∂·ûö·ûò·üí·ûó',
        phonetic: 'pruoy ba-rom',
        english: 'Worried',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/worried.mp3'
      },
      {
        front: '·ûÅ·ûπ·ûÑ',
        phonetic: 'kh…ông',
        english: 'Angry',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/angry.mp3'
      },
      {
        front: '·ûü·üí·ûö·û°·û∂·ûâ·üã',
        phonetic: 'sralanh',
        english: 'To love',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/to_love.mp3'
      },

      // (16) Clothes (5)
      {
        front: '·û¢·û∂·ûú',
        phonetic: 'aav',
        english: 'Shirt',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/shirt.mp3'
      },
      {
        front: '·ûÅ·üÑ',
        phonetic: 'khaov',
        english: 'Pants',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/pants.mp3'
      },
      {
        front: '·ûü·üí·ûî·üÇ·ûÄ·ûá·ûæ·ûÑ',
        phonetic: 'sbaek-j…ô…ông',
        english: 'Shoes',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/shoes.mp3'
      },
      {
        front: '·ûò·ûΩ·ûÄ',
        phonetic: 'mu≈èk',
        english: 'Hat',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/hat.mp3'
      },
      {
        front: '·ûü·üÜ·ûñ·ûè·üã',
        phonetic: 'som-pot',
        english: 'Skirt',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/skirt.mp3'
      },

      // (17) Days of the Week (7)
      {
        front: '·ûê·üí·ûÑ·üÉ·û¢·û∂·ûë·û∑·ûè·üí·ûô',
        phonetic: 'thngay aa-tit',
        english: 'Sunday',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/sunday.mp3'
      },
      {
        front: '·ûê·üí·ûÑ·üÉ·ûÖ·ûì·üí·ûë',
        phonetic: 'thngay chan',
        english: 'Monday',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/monday.mp3'
      },
      {
        front: '·ûê·üí·ûÑ·üÉ·û¢·ûÑ·üí·ûÇ·û∂·ûö',
        phonetic: 'thngay ong-kea',
        english: 'Tuesday',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/tuesday.mp3'
      },
      {
        front: '·ûê·üí·ûÑ·üÉ·ûñ·ûª·ûí',
        phonetic: 'thngay puth',
        english: 'Wednesday',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/wednesday.mp3'
      },
      {
        front: '·ûê·üí·ûÑ·üÉ·ûñ·üí·ûö·û†·ûü·üí·ûî·ûè·û∑·üç',
        phonetic: 'thngay pro-hos',
        english: 'Thursday',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/thursday.mp3'
      },
      {
        front: '·ûê·üí·ûÑ·üÉ·ûü·ûª·ûÄ·üí·ûö',
        phonetic: 'thngay sok',
        english: 'Friday',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/friday.mp3'
      },
      {
        front: '·ûê·üí·ûÑ·üÉ·ûü·üÖ·ûö·üç',
        phonetic: 'thngay sao',
        english: 'Saturday',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/saturday.mp3'
      },

      // (18) Months (7) => 100 total
      {
        front: '·ûò·ûÄ·ûö·û∂',
        phonetic: 'm√¥k-kaa-ra',
        english: 'January',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/january.mp3'
      },
      {
        front: '·ûÄ·ûª·ûò·üí·ûó·üà',
        phonetic: 'k≈èm-pheƒÉk',
        english: 'February',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/february.mp3'
      },
      {
        front: '·ûò·û∑·ûì·û∂',
        phonetic: 'me-niia',
        english: 'March',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/march.mp3'
      },
      {
        front: '·ûò·üÅ·ûü·û∂',
        phonetic: 'me-sa',
        english: 'April',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/april.mp3'
      },
      {
        front: '·ûß·ûü·ûó·û∂',
        phonetic: 'ou-sa-phiia',
        english: 'May',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/may.mp3'
      },
      {
        front: '·ûò·û∑·ûê·ûª·ûì·û∂',
        phonetic: 'mi-thu-naa',
        english: 'June',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/june.mp3'
      },
      {
        front: '·ûÄ·ûÄ·üí·ûÄ·ûä·û∂',
        phonetic: 'kƒÉk-kƒÉ-daa',
        english: 'July',
        audio: 'https://raw.githubusercontent.com/SharkyTim/khmer-audio/main/audio/july.mp3'
      },
    ];

    /************************************************************
     *  GLOBAL STATE
     ************************************************************/
    let selectedIndexes = [];
    let currentIndex = -1;
    let isCardFlipped = false;

    // DOM references
    const cardsSelection    = document.getElementById('cards-selection');
    const selectedCountSpan = document.getElementById('selected-count');
    const selectAllBtn      = document.getElementById('select-all');
    const deselectAllBtn    = document.getElementById('deselect-all');
    const startTrainingBtn  = document.getElementById('start-training');

    const cardSection       = document.getElementById('card-section');
    const cardContainer     = document.getElementById('card-container');
    const cardInner         = document.getElementById('card-inner');
    const cardFront         = document.getElementById('card-front');
    const cardBack          = document.getElementById('card-back');

    const practiceControls  = document.getElementById('practice-controls');
    const gotItBtn          = document.getElementById('got-it');
    const tryAgainBtn       = document.getElementById('try-again');
    const endSessionBtn     = document.getElementById('end-session');

    const ttsButton         = document.getElementById('tts-button');
    const ttsAudio          = document.getElementById('tts-audio');

    /************************************************************
     *  1) GENERATE CARD SELECTION
     ************************************************************/
    khmerWords.forEach((wordObj, index) => {
      const div = document.createElement('div');
      div.classList.add('card-option');
      div.textContent = wordObj.front; // Show Khmer script

      div.addEventListener('click', () => {
        // Toggle selection
        if (selectedIndexes.includes(index)) {
          // Deselect
          selectedIndexes = selectedIndexes.filter(i => i !== index);
          div.classList.remove('selected');
        } else {
          // Select
          selectedIndexes.push(index);
          div.classList.add('selected');
        }
        selectedCountSpan.textContent = selectedIndexes.length;
      });

      cardsSelection.appendChild(div);
    });

    /************************************************************
     *  2) SELECT/DESELECT ALL
     ************************************************************/
    selectAllBtn.addEventListener('click', () => {
      selectedIndexes = khmerWords.map((_, i) => i); // all indices
      selectedCountSpan.textContent = selectedIndexes.length;

      document.querySelectorAll('.card-option').forEach((cardOption) => {
        cardOption.classList.add('selected');
      });
    });

    deselectAllBtn.addEventListener('click', () => {
      selectedIndexes = [];
      selectedCountSpan.textContent = 0;

      document.querySelectorAll('.card-option').forEach((cardOption) => {
        cardOption.classList.remove('selected');
      });
    });

    /************************************************************
     *  3) START PRACTICE
     ************************************************************/
    startTrainingBtn.addEventListener('click', () => {
      if (selectedIndexes.length === 0) {
        alert('Please select at least one card before starting.');
        return;
      }

      // Hide selection UI
      cardsSelection.style.display = 'none';
      selectAllBtn.style.display = 'none';
      deselectAllBtn.style.display = 'none';
      startTrainingBtn.style.display = 'none';

      // Show card + practice controls
      cardSection.style.display = 'block';
      practiceControls.style.display = 'flex';

      // Shuffle the selected cards
      shuffleArray(selectedIndexes);

      currentIndex = 0;
      showCard(currentIndex);
    });

    /************************************************************
     *  4) PRACTICE CONTROLS
     ************************************************************/
    // "I Know It" => remove card from deck
    gotItBtn.addEventListener('click', () => {
      selectedIndexes.splice(currentIndex, 1);
      if (selectedIndexes.length === 0) {
        alert('Awesome! You finished all cards.');
        endSession();
        return;
      }
      if (currentIndex >= selectedIndexes.length) {
        currentIndex = 0;
      }
      showCard(currentIndex);
    });

    // "Try Again" => keep card, just go next
    tryAgainBtn.addEventListener('click', () => {
      currentIndex++;
      if (currentIndex >= selectedIndexes.length) {
        currentIndex = 0;
      }
      showCard(currentIndex);
    });

    // "End Session"
    endSessionBtn.addEventListener('click', () => {
      endSession();
    });

    // Flip card on container click (but ignore TTS button)
    cardContainer.addEventListener('click', (e) => {
      if (!e.target.classList.contains('tts-button')) {
        flipCard();
      }
    });

    /************************************************************
     *  5) TTS BUTTON (plays your MP3 from GitHub)
     ************************************************************/
    ttsButton.addEventListener('click', () => {
      if (!ttsAudio.src) {
        alert('Audio not ready yet. Please try again.');
        return;
      }
      // Attempt to play
      ttsAudio.play().catch(err => {
        console.log('Audio play error:', err);
        alert('Audio blocked. Please ensure your device volume is on and try again.');
      });
    });

    /************************************************************
     *  HELPER FUNCTIONS
     ************************************************************/

    // Show card by index
    function showCard(idx) {
      cardContainer.classList.remove('card-flipped');
      isCardFlipped = false;

      const w = khmerWords[selectedIndexes[idx]];
      // Front: Khmer script
      cardFront.textContent = w.front;
      // Back: phonetic + English
      cardBack.innerHTML = `
        <div>${w.phonetic}</div>
        <div style="margin-top:8px; font-size:0.9em;">${w.english}</div>
      `;

      // Load user-provided MP3
      ttsAudio.src = w.audio;
      ttsAudio.load();
    }

    // Flip card
    function flipCard() {
      isCardFlipped = !isCardFlipped;
      if (isCardFlipped) {
        cardContainer.classList.add('card-flipped');
      } else {
        cardContainer.classList.remove('card-flipped');
      }
    }

    // End session => show selection again, reset
    function endSession() {
      cardsSelection.style.display = 'grid';
      selectAllBtn.style.display = 'inline-block';
      deselectAllBtn.style.display = 'inline-block';
      startTrainingBtn.style.display = 'inline-block';

      cardSection.style.display = 'none';
      practiceControls.style.display = 'none';

      selectedIndexes = [];
      selectedCountSpan.textContent = 0;

      document.querySelectorAll('.card-option').forEach(div => {
        div.classList.remove('selected');
      });
    }

    // Shuffle array in-place
    function shuffleArray(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }
  </script>
</body>
</html>
